{"last_node_id":81,"last_link_id":227,"nodes":[{"id":40,"type":"Reroute","pos":[504,484],"size":[75,26],"flags":{},"order":7,"mode":0,"inputs":[{"name":"","type":"*","link":148,"label":""}],"outputs":[{"name":"VAE","type":"VAE","links":[150,159,163],"slot_index":0,"label":"VAE"}],"properties":{"showOutputText":true,"horizontal":false}},{"id":2,"type":"CheckpointLoaderSimple","pos":[-500.0284423828125,388.62725830078125],"size":[315,98],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[{"name":"MODEL","type":"MODEL","links":[156],"slot_index":0,"shape":3,"label":"MODEL"},{"name":"CLIP","type":"CLIP","links":[4,5],"slot_index":1,"shape":3,"label":"CLIP"},{"name":"VAE","type":"VAE","links":[10,148],"slot_index":2,"shape":3,"label":"VAE"}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["realistic\\繁花_写真-10_繁花-10.safetensors"]},{"id":37,"type":"LoadAndApplyICLightUnet","pos":[489,365],"size":[381.3333740234375,58],"flags":{},"order":4,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":156,"label":"model"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[137],"slot_index":0,"shape":3,"label":"MODEL"}],"properties":{"Node name for S&R":"LoadAndApplyICLightUnet"},"widgets_values":["IC-Light\\iclight_sd15_fc.safetensors"]},{"id":45,"type":"VAEEncode","pos":[530.6145629882812,599.57568359375],"size":[210,46],"flags":{},"order":10,"mode":0,"inputs":[{"name":"pixels","type":"IMAGE","link":169,"slot_index":0,"label":"pixels"},{"name":"vae","type":"VAE","link":163,"slot_index":1,"label":"vae"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[160],"shape":3,"label":"LATENT"}],"properties":{"Node name for S&R":"VAEEncode"},"widgets_values":[]},{"id":44,"type":"ICLightConditioning","pos":[770.326904296875,472.2292785644531],"size":[342.5999755859375,138],"flags":{},"order":13,"mode":0,"inputs":[{"name":"positive","type":"CONDITIONING","link":157,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":158,"label":"negative"},{"name":"vae","type":"VAE","link":159,"label":"vae"},{"name":"foreground","type":"LATENT","link":160,"slot_index":3,"label":"foreground"},{"name":"opt_background","type":"LATENT","link":null,"shape":7,"label":"opt_background"}],"outputs":[{"name":"positive","type":"CONDITIONING","links":[161],"slot_index":0,"shape":3,"label":"positive"},{"name":"negative","type":"CONDITIONING","links":[162],"slot_index":1,"shape":3,"label":"negative"},{"name":"empty_latent","type":"LATENT","links":null,"shape":3,"label":"empty_latent"}],"properties":{"Node name for S&R":"ICLightConditioning"},"widgets_values":[0.18215]},{"id":7,"type":"VAEDecode","pos":[1642,399],"size":[210,46],"flags":{},"order":22,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":77,"label":"samples"},{"name":"vae","type":"VAE","link":10,"slot_index":1,"label":"vae"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[179],"slot_index":0,"shape":3,"label":"IMAGE"}],"properties":{"Node name for S&R":"VAEDecode"},"widgets_values":[]},{"id":69,"type":"Note","pos":[1679.7376708984375,582.1741333007812],"size":[271.3703308105469,107.12195587158203],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["denoise: 1或者0.9， 1的花参照原图更多"],"color":"#432","bgcolor":"#653"},{"id":5,"type":"CLIPTextEncode","pos":[-31.523605346679688,693.2571411132812],"size":[400,200],"flags":{},"order":6,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":5,"label":"clip"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[158],"slot_index":0,"shape":3,"label":"CONDITIONING"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""],"color":"#322","bgcolor":"#533"},{"id":19,"type":"KSampler","pos":[1255,377],"size":[315,474],"flags":{},"order":21,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":137,"slot_index":0,"label":"model"},{"name":"positive","type":"CONDITIONING","link":161,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":162,"slot_index":2,"label":"negative"},{"name":"latent_image","type":"LATENT","link":123,"label":"latent_image"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[77],"slot_index":0,"shape":3,"label":"LATENT"}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[389607121219598,"randomize",25,2.05,"dpmpp_2m","karras",0.9]},{"id":59,"type":"PreviewBridge","pos":[-1220.38037109375,1397.4549560546875],"size":[315,338],"flags":{},"order":9,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":208,"label":"images"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[],"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":[196],"slot_index":1,"label":"MASK"}],"properties":{"Node name for S&R":"PreviewBridge"},"widgets_values":["$59-1737467290.013977",false,"if_same_size"]},{"id":79,"type":"PreviewImage","pos":[-832.321044921875,1373.9173583984375],"size":[210,246],"flags":{},"order":16,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":220,"label":"images"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":63,"type":"MaskToImage","pos":[-856.8209228515625,1282.780029296875],"size":[264.5999755859375,26],"flags":{},"order":14,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":206,"label":"mask"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[218,220],"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"MaskToImage"},"widgets_values":[]},{"id":51,"type":"DetailTransfer","pos":[1030,1100],"size":[315,146],"flags":{},"order":24,"mode":0,"inputs":[{"name":"target","type":"IMAGE","link":180,"label":"target"},{"name":"source","type":"IMAGE","link":181,"label":"source"},{"name":"mask","type":"MASK","link":183,"shape":7,"label":"mask"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[185],"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"DetailTransfer"},"widgets_values":["soft_light",0.1,0.55]},{"id":20,"type":"VAEEncode","pos":[622.8353271484375,864.36279296875],"size":[210,46],"flags":{},"order":19,"mode":0,"inputs":[{"name":"pixels","type":"IMAGE","link":219,"slot_index":0,"label":"pixels"},{"name":"vae","type":"VAE","link":150,"slot_index":1,"label":"vae"}],"outputs":[{"name":"LATENT","type":"LATENT","links":[123],"slot_index":0,"shape":3,"label":"LATENT"}],"properties":{"Node name for S&R":"VAEEncode"},"widgets_values":[]},{"id":80,"type":"PreviewImage","pos":[-41.30758285522461,1619.09814453125],"size":[210,246],"flags":{},"order":20,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":221,"label":"images"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":78,"type":"Switch any [Crystools]","pos":[-452.86212158203125,1569.6329345703125],"size":[315,78],"flags":{},"order":18,"mode":0,"inputs":[{"name":"on_true","type":"*","link":218,"label":"on_true"},{"name":"on_false","type":"*","link":217,"label":"on_false"}],"outputs":[{"name":"*","type":"*","links":[219,221],"slot_index":0,"label":"*"}],"title":"是否需要垫图","properties":{"Node name for S&R":"Switch any [Crystools]"},"widgets_values":[false]},{"id":53,"type":"RembgNode_Mix","pos":[-885.6668701171875,882.29150390625],"size":[327.5999755859375,98],"flags":{},"order":8,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":182,"label":"image"}],"outputs":[{"name":"masks","type":"MASK","links":[183],"slot_index":0,"shape":6,"label":"masks"},{"name":"images","type":"IMAGE","links":[222],"slot_index":1,"shape":6,"label":"images"},{"name":"RGBAs","type":"RGBA","links":null,"shape":6,"label":"RGBAs"}],"properties":{"Node name for S&R":"RembgNode_Mix"},"widgets_values":["briarmbg"]},{"id":81,"type":"Switch any [Crystools]","pos":[-880.1217041015625,1087.2908935546875],"size":[315,78],"flags":{},"order":11,"mode":0,"inputs":[{"name":"on_true","type":"*","link":222,"label":"on_true"},{"name":"on_false","type":"*","link":223,"label":"on_false"}],"outputs":[{"name":"*","type":"*","links":[224],"slot_index":0,"label":"*"}],"properties":{"Node name for S&R":"Switch any [Crystools]"},"widgets_values":[true]},{"id":55,"type":"PreviewBridge","pos":[1393.08837890625,908.05859375],"size":[315,338.00006103515625],"flags":{},"order":25,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":185,"label":"images"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[186,226],"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":null,"label":"MASK"}],"properties":{"Node name for S&R":"PreviewBridge"},"widgets_values":["$55-0",false,"never"]},{"id":52,"type":"PreviewBridge","pos":[541.6879272460938,1087.8193359375],"size":[315,338],"flags":{},"order":23,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":179,"label":"images"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[180,227],"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":null,"label":"MASK"}],"properties":{"Node name for S&R":"PreviewBridge"},"widgets_values":["$52-0",false,"never"]},{"id":70,"type":"Note","pos":[718.0108642578125,1638.1273193359375],"size":[496.3944091796875,180.96168518066406],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["detail transfer: \nsource, 未修改得原图\ntarget: 打光后的图\n\n\nmode: add, blur_sigma: 3, blend_factor: 0.8， blur_sigma值越高，和原图越接近\nmode: soft, blur_sigma: 0, blend_factor: 0.55，blend_factor值越高，和原图色调越接近"],"color":"#432","bgcolor":"#653"},{"id":60,"type":"RemapMaskRange","pos":[-1238.38232421875,1845.518798828125],"size":[315,82],"flags":{},"order":12,"mode":0,"inputs":[{"name":"mask","type":"MASK","link":196,"label":"mask"}],"outputs":[{"name":"mask","type":"MASK","links":[206,213],"slot_index":0,"label":"mask"}],"properties":{"Node name for S&R":"RemapMaskRange"},"widgets_values":[0.08,0.6]},{"id":76,"type":"ImageAndMaskPreview","pos":[-771.1114501953125,1749.817138671875],"size":[315,338],"flags":{"collapsed":false},"order":15,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":224,"shape":7,"label":"image"},{"name":"mask","type":"MASK","link":213,"shape":7,"label":"mask"}],"outputs":[{"name":"composite","type":"IMAGE","links":[215,217],"slot_index":0,"label":"composite"}],"properties":{"Node name for S&R":"ImageAndMaskPreview"},"widgets_values":[1,"255, 255, 255",true]},{"id":77,"type":"PreviewImage","pos":[-384.9148254394531,1856.719970703125],"size":[210,246],"flags":{},"order":17,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":215,"label":"images"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":9,"type":"LoadImage","pos":[-1252.100341796875,717.8609619140625],"size":[315,314.0000305175781],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[169,181,182,192,208,209,223],"slot_index":0,"shape":3,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":[],"shape":3,"label":"MASK"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["ComfyUI_temp_xlbdn_00010_.png","image"]},{"id":4,"type":"CLIPTextEncode","pos":[-16.517784118652344,408.0962829589844],"size":[400,200],"flags":{},"order":5,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":4,"label":"clip"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[157],"slot_index":0,"shape":3,"label":"CONDITIONING"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["glowing colorful light particles"],"color":"#232","bgcolor":"#353"},{"id":75,"type":"PreviewImage","pos":[1609.791748046875,1465.750244140625],"size":[738.9860229492188,563.3916625976562],"flags":{},"order":29,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":212,"label":"images"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":56,"type":"ColorMatch","pos":[1776.37646484375,895.2852172851562],"size":[315,102],"flags":{},"order":26,"mode":0,"inputs":[{"name":"image_ref","type":"IMAGE","link":192,"label":"image_ref"},{"name":"image_target","type":"IMAGE","link":186,"label":"image_target"}],"outputs":[{"name":"image","type":"IMAGE","links":[188,225],"slot_index":0,"label":"image"}],"properties":{"Node name for S&R":"ColorMatch"},"widgets_values":["mkl",0.5]},{"id":74,"type":"ImageConcatMulti","pos":[1830.2332763671875,1149.089111328125],"size":[210,190],"flags":{},"order":28,"mode":0,"inputs":[{"name":"image_1","type":"IMAGE","link":209,"label":"image_1"},{"name":"image_2","type":"IMAGE","link":227,"label":"image_2"},{"name":"image_3","type":"IMAGE","link":226,"label":"image_3"},{"name":"image_4","type":"IMAGE","link":225,"label":"image_4"}],"outputs":[{"name":"images","type":"IMAGE","links":[212],"slot_index":0,"label":"images"}],"properties":{},"widgets_values":[4,"right",false,null]},{"id":57,"type":"PreviewImage","pos":[2207.455078125,884.4036254882812],"size":[252.35812377929688,341.5582275390625],"flags":{},"order":27,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":188,"label":"images"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]}],"links":[[4,2,1,4,0,"CLIP"],[5,2,1,5,0,"CLIP"],[10,2,2,7,1,"VAE"],[77,19,0,7,0,"LATENT"],[123,20,0,19,3,"LATENT"],[137,37,0,19,0,"MODEL"],[148,2,2,40,0,"*"],[150,40,0,20,1,"VAE"],[156,2,0,37,0,"MODEL"],[157,4,0,44,0,"CONDITIONING"],[158,5,0,44,1,"CONDITIONING"],[159,40,0,44,2,"VAE"],[160,45,0,44,3,"LATENT"],[161,44,0,19,1,"CONDITIONING"],[162,44,1,19,2,"CONDITIONING"],[163,40,0,45,1,"VAE"],[169,9,0,45,0,"IMAGE"],[179,7,0,52,0,"IMAGE"],[180,52,0,51,0,"IMAGE"],[181,9,0,51,1,"IMAGE"],[182,9,0,53,0,"IMAGE"],[183,53,0,51,2,"MASK"],[185,51,0,55,0,"IMAGE"],[186,55,0,56,1,"IMAGE"],[188,56,0,57,0,"IMAGE"],[192,9,0,56,0,"IMAGE"],[196,59,1,60,0,"MASK"],[206,60,0,63,0,"MASK"],[208,9,0,59,0,"IMAGE"],[209,9,0,74,0,"IMAGE"],[212,74,0,75,0,"IMAGE"],[213,60,0,76,1,"MASK"],[215,76,0,77,0,"IMAGE"],[217,76,0,78,1,"*"],[218,63,0,78,0,"*"],[219,78,0,20,0,"IMAGE"],[220,63,0,79,0,"IMAGE"],[221,78,0,80,0,"IMAGE"],[222,53,1,81,0,"*"],[223,9,0,81,1,"*"],[224,81,0,76,0,"IMAGE"],[225,56,0,74,3,"IMAGE"],[226,55,0,74,2,"IMAGE"],[227,52,0,74,1,"IMAGE"]],"groups":[{"id":1,"title":"latent 生成","bounding":[-1254.4244384765625,1209.1800537109375,1126.56201171875,796.8873291015625],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.7627768444385483,"offset":[-490.0521107547978,-613.2250930835593]}},"version":0.4}