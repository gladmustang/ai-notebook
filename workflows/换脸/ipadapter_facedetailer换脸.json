{"last_node_id":109,"last_link_id":204,"nodes":[{"id":29,"type":"LayerMask: PersonMaskUltra V2","pos":[3353.55029296875,-1518.2615966796875],"size":[365.4000244140625,414],"flags":{},"order":11,"mode":2,"inputs":[{"name":"images","type":"IMAGE","link":32,"label":"images"}],"outputs":[{"name":"image","type":"IMAGE","links":[],"slot_index":0,"label":"image"},{"name":"mask","type":"MASK","links":[51],"slot_index":1,"label":"mask"}],"properties":{"Node name for S&R":"LayerMask: PersonMaskUltra V2"},"widgets_values":[true,false,false,false,false,false,0.4,"VITMatte",6,6,0.01,0.99,true,"cuda",2],"color":"rgba(27, 80, 119, 0.7)"},{"id":23,"type":"ToBasicPipe","pos":[5931.84326171875,-1125.6329345703125],"size":[241.79998779296875,106],"flags":{},"order":24,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":146,"label":"model"},{"name":"clip","type":"CLIP","link":129,"label":"clip"},{"name":"vae","type":"VAE","link":45,"label":"vae"},{"name":"positive","type":"CONDITIONING","link":48,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":49,"label":"negative"}],"outputs":[{"name":"basic_pipe","type":"BASIC_PIPE","links":[65],"slot_index":0,"label":"basic_pipe"}],"properties":{"Node name for S&R":"ToBasicPipe"},"widgets_values":[]},{"id":38,"type":"CLIPTextEncode","pos":[5271.5634765625,-758.0289916992188],"size":[400,200],"flags":{},"order":16,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":126,"label":"clip"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[49],"slot_index":0,"label":"CONDITIONING"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["watermark, "]},{"id":44,"type":"BasicPipeToDetailerPipe","pos":[6352.5263671875,-1089.8963623046875],"size":[400,204],"flags":{},"order":25,"mode":0,"inputs":[{"name":"basic_pipe","type":"BASIC_PIPE","link":65,"label":"basic_pipe"},{"name":"bbox_detector","type":"BBOX_DETECTOR","link":73,"label":"bbox_detector"},{"name":"sam_model_opt","type":"SAM_MODEL","link":69,"shape":7,"label":"sam_model_opt"},{"name":"segm_detector_opt","type":"SEGM_DETECTOR","link":70,"shape":7,"label":"segm_detector_opt"},{"name":"detailer_hook","type":"DETAILER_HOOK","link":null,"shape":7,"label":"detailer_hook"}],"outputs":[{"name":"detailer_pipe","type":"DETAILER_PIPE","links":[66],"slot_index":0,"label":"detailer_pipe"}],"properties":{"Node name for S&R":"BasicPipeToDetailerPipe"},"widgets_values":["","Select the LoRA to add to the text","Select the Wildcard to add to the text"]},{"id":48,"type":"UltralyticsDetectorProvider","pos":[5843.9541015625,-934.1943359375],"size":[340.20001220703125,78],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":[73],"slot_index":0,"label":"BBOX_DETECTOR"},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":[],"label":"SEGM_DETECTOR"}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["bbox/face_yolov8m.pt"]},{"id":45,"type":"SAMLoader","pos":[5864.75439453125,-805.8419189453125],"size":[315,82],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[{"name":"SAM_MODEL","type":"SAM_MODEL","links":[69],"slot_index":0,"label":"SAM_MODEL"}],"properties":{"Node name for S&R":"SAMLoader"},"widgets_values":["sam_vit_h_4b8939.pth","CPU"]},{"id":46,"type":"UltralyticsDetectorProvider","pos":[5852.9794921875,-669.0774536132812],"size":[340.20001220703125,78],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":null,"label":"BBOX_DETECTOR"},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":[70],"slot_index":1,"label":"SEGM_DETECTOR"}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["segm/person_yolov8m-seg.pt"]},{"id":34,"type":"CheckpointLoaderSimple","pos":[4818.32861328125,-1032.0966796875],"size":[315,98],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[{"name":"MODEL","type":"MODEL","links":[123],"slot_index":0,"label":"MODEL"},{"name":"CLIP","type":"CLIP","links":[124],"slot_index":1,"label":"CLIP"},{"name":"VAE","type":"VAE","links":null,"slot_index":2,"label":"VAE"}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["realistic\\繁花_写真-10_繁花-10.safetensors"]},{"id":71,"type":"Power Lora Loader (rgthree)","pos":[4824.921875,-851.60791015625],"size":[340.20001220703125,142],"flags":{},"order":10,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":123,"label":"model","dir":3},{"name":"clip","type":"CLIP","link":124,"label":"clip","dir":3}],"outputs":[{"name":"MODEL","type":"MODEL","links":[127,202],"slot_index":0,"shape":3,"label":"MODEL","dir":4},{"name":"CLIP","type":"CLIP","links":[125,126,129],"slot_index":1,"shape":3,"label":"CLIP","dir":4}],"properties":{"Show Strengths":"Single Strength"},"widgets_values":[null,{"type":"PowerLoraLoaderHeaderWidget"},{"on":true,"lora":"LCM\\LCM_LoRA_Weights_SD15.safetensors","strength":0.8,"strengthTwo":null},null,""]},{"id":36,"type":"VAELoader","pos":[4832.62744140625,-638.2057495117188],"size":[315,58],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[{"name":"VAE","type":"VAE","links":[45],"slot_index":0,"label":"VAE"}],"properties":{"Node name for S&R":"VAELoader"},"widgets_values":["vae-ft-mse-840000-ema-pruned.safetensors"]},{"id":42,"type":"FaceDetailerPipe","pos":[6888.10009765625,-1111.4150390625],"size":[519,782],"flags":{},"order":26,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":67,"label":"image"},{"name":"detailer_pipe","type":"DETAILER_PIPE","link":66,"label":"detailer_pipe"},{"name":"scheduler_func_opt","type":"SCHEDULER_FUNC","link":null,"shape":7,"label":"scheduler_func_opt"},{"name":"seed","type":"INT","link":71,"widget":{"name":"seed"},"label":"seed"}],"outputs":[{"name":"image","type":"IMAGE","links":[68],"slot_index":0,"label":"image"},{"name":"cropped_refined","type":"IMAGE","links":null,"shape":6,"label":"cropped_refined"},{"name":"cropped_enhanced_alpha","type":"IMAGE","links":null,"shape":6,"label":"cropped_enhanced_alpha"},{"name":"mask","type":"MASK","links":null,"label":"mask"},{"name":"detailer_pipe","type":"DETAILER_PIPE","links":null,"label":"detailer_pipe"},{"name":"cnet_images","type":"IMAGE","links":null,"shape":6,"label":"cnet_images"}],"properties":{"Node name for S&R":"FaceDetailerPipe"},"widgets_values":[512,true,1024,455551764087287,"randomize",8,1.3,"lcm","sgm_uniform",0.67,5,true,true,0.5,10,3,"center-1",0,0.93,0,0.7,"False",10,0.2,1,false,20]},{"id":39,"type":"ImageCropByMaskAndResize","pos":[3740.854736328125,-1516.665283203125],"size":[365.4000244140625,170],"flags":{},"order":17,"mode":2,"inputs":[{"name":"image","type":"IMAGE","link":50,"label":"image"},{"name":"mask","type":"MASK","link":51,"label":"mask"}],"outputs":[{"name":"images","type":"IMAGE","links":[196],"slot_index":0,"label":"images"},{"name":"masks","type":"MASK","links":null,"label":"masks"},{"name":"bbox","type":"BBOX","links":null,"label":"bbox"}],"properties":{"Node name for S&R":"ImageCropByMaskAndResize"},"widgets_values":[512,0,128,512]},{"id":104,"type":"HMFaceToolkitsLoader","pos":[3377.918701171875,-1771.432861328125],"size":[315,82],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[{"name":"face_toolkits","type":"FACE_TOOLKITS","links":[192],"label":"face_toolkits","slot_index":0}],"properties":{"Node name for S&R":"HMFaceToolkitsLoader"},"widgets_values":[0,"modelscope"]},{"id":57,"type":"ImpactMakeImageBatch","pos":[4521.134765625,-1530.2904052734375],"size":[140,46],"flags":{},"order":19,"mode":0,"inputs":[{"name":"image1","type":"IMAGE","link":198},{"name":"image2","type":"IMAGE","link":null}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[92],"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"ImpactMakeImageBatch"},"widgets_values":[]},{"id":106,"type":"Any Switch (rgthree)","pos":[4261.810546875,-1544.1357421875],"size":[168,106],"flags":{},"order":18,"mode":0,"inputs":[{"name":"any_01","type":"IMAGE","link":201,"dir":3},{"name":"any_02","type":"IMAGE","link":196,"dir":3},{"name":"any_03","type":"IMAGE","link":null,"dir":3},{"name":"any_04","type":"IMAGE","link":null,"dir":3},{"name":"any_05","type":"IMAGE","link":null,"dir":3}],"outputs":[{"name":"*","type":"IMAGE","links":[197,198,199],"shape":3,"label":"IMAGE","dir":4,"slot_index":0}],"properties":{},"widgets_values":[]},{"id":40,"type":"PreviewImage","pos":[4359.970703125,-1339.114990234375],"size":[210,246],"flags":{},"order":20,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":199,"label":"images"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":37,"type":"CLIPTextEncode","pos":[5261.1416015625,-1091.68701171875],"size":[400,200],"flags":{},"order":15,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":125,"label":"clip"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[48],"slot_index":0,"label":"CONDITIONING"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["master piece, best quality"]},{"id":28,"type":"LoadImage","pos":[2813.04296875,-1615.0682373046875],"size":[315,314],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[32,50,193],"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":[],"slot_index":1,"label":"MASK"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["ComfyUI_temp_bvjgt_00001_.png","image"]},{"id":21,"type":"Seed (rgthree)","pos":[6578.958984375,-504.5372009277344],"size":[210,130],"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[{"name":"SEED","type":"INT","links":[71],"slot_index":0,"shape":3,"label":"SEED","dir":4}],"properties":{},"widgets_values":[290057111453703,null,null,null]},{"id":97,"type":"Load Image Batch","pos":[4660.97705078125,-42.338871002197266],"size":[315,222],"flags":{},"order":8,"mode":0,"inputs":[],"outputs":[{"name":"image","type":"IMAGE","links":[],"slot_index":0,"label":"image"},{"name":"filename_text","type":"STRING","links":null,"label":"filename_text"}],"properties":{"Node name for S&R":"Load Image Batch"},"widgets_values":["incremental_image",0,"Batch 001","D:\\work\\comfyui\\作品\\作品51\\服装3\\pics\\selected\\for wife\\selected","*","false","true"]},{"id":41,"type":"PreviewImage","pos":[6511.234375,-125.45134735107422],"size":[656.0148315429688,1083.8514404296875],"flags":{},"order":27,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":68,"label":"images"}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":25,"type":"LoadImage","pos":[5289.14892578125,-127.99874877929688],"size":[644.7804565429688,1148.6837158203125],"flags":{},"order":9,"mode":0,"inputs":[],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[67],"slot_index":0,"label":"IMAGE"},{"name":"MASK","type":"MASK","links":null,"label":"MASK"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["2025-01-01_0001.png","image"]},{"id":50,"type":"IPAdapterUnifiedLoader","pos":[5711.2109375,-1670.119140625],"size":[315,78],"flags":{},"order":22,"mode":4,"inputs":[{"name":"model","type":"MODEL","link":77,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","link":78,"shape":7,"label":"ipadapter"}],"outputs":[{"name":"model","type":"MODEL","links":[75],"slot_index":0,"shape":3,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","links":[76],"slot_index":1,"shape":3,"label":"ipadapter"}],"properties":{"Node name for S&R":"IPAdapterUnifiedLoader"},"widgets_values":["FULL FACE - SD1.5 only (portraits stronger)"]},{"id":51,"type":"IPAdapter","pos":[5697.19189453125,-1539.373779296875],"size":[315,190],"flags":{},"order":23,"mode":4,"inputs":[{"name":"model","type":"MODEL","link":75,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","link":76,"slot_index":1,"label":"ipadapter"},{"name":"image","type":"IMAGE","link":97,"label":"image"},{"name":"attn_mask","type":"MASK","link":null,"shape":7,"label":"attn_mask"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[146],"slot_index":0,"shape":3,"label":"MODEL"}],"properties":{"Node name for S&R":"IPAdapter"},"widgets_values":[0.4,0,1,"standard"]},{"id":105,"type":"CropPortrait","pos":[3803.653076171875,-1754.357421875],"size":[241.79998779296875,46],"flags":{},"order":12,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":193,"label":"image"},{"name":"face_toolkits","type":"FACE_TOOLKITS","link":192,"label":"face_toolkits"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[201],"label":"IMAGE","slot_index":0}],"properties":{"Node name for S&R":"CropPortrait"}},{"id":32,"type":"IPAdapterUnifiedLoaderFaceID","pos":[4823.97119140625,-1671.397216796875],"size":[390.5999755859375,126],"flags":{},"order":13,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":127,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","link":null,"shape":7,"label":"ipadapter"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[],"slot_index":0,"label":"MODEL"},{"name":"ipadapter","type":"IPADAPTER","links":[78],"slot_index":1,"label":"ipadapter"}],"properties":{"Node name for S&R":"IPAdapterUnifiedLoaderFaceID"},"widgets_values":["FACEID PLUS V2",0.6,"CPU"]},{"id":33,"type":"IPAdapterFaceID","pos":[5271.34814453125,-1657.1822509765625],"size":[317.4000244140625,322],"flags":{},"order":21,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":203,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","link":204,"label":"ipadapter"},{"name":"image","type":"IMAGE","link":92,"label":"image"},{"name":"image_negative","type":"IMAGE","link":null,"shape":7,"label":"image_negative"},{"name":"attn_mask","type":"MASK","link":null,"shape":7,"label":"attn_mask"},{"name":"clip_vision","type":"CLIP_VISION","link":null,"shape":7,"label":"clip_vision"},{"name":"insightface","type":"INSIGHTFACE","link":null,"shape":7,"label":"insightface"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[77],"slot_index":0,"label":"MODEL"},{"name":"face_image","type":"IMAGE","links":[97],"slot_index":1,"label":"face_image"}],"properties":{"Node name for S&R":"IPAdapterFaceID"},"widgets_values":[1,2,"linear","concat",0,1,"K+V"]},{"id":108,"type":"IPAdapterUnifiedLoaderFaceID","pos":[4821.87744140625,-1474.3343505859375],"size":[390.5999755859375,126],"flags":{},"order":14,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":202,"label":"model"},{"name":"ipadapter","type":"IPADAPTER","link":null,"shape":7,"label":"ipadapter"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[203],"slot_index":0,"label":"MODEL"},{"name":"ipadapter","type":"IPADAPTER","links":[204],"slot_index":1,"label":"ipadapter"}],"properties":{"Node name for S&R":"IPAdapterUnifiedLoaderFaceID"},"widgets_values":["FACEID",0.8,"CPU"]}],"links":[[32,28,0,29,0,"IMAGE"],[45,36,0,23,2,"VAE"],[48,37,0,23,3,"CONDITIONING"],[49,38,0,23,4,"CONDITIONING"],[50,28,0,39,0,"IMAGE"],[51,29,1,39,1,"MASK"],[65,23,0,44,0,"BASIC_PIPE"],[66,44,0,42,1,"DETAILER_PIPE"],[67,25,0,42,0,"IMAGE"],[68,42,0,41,0,"IMAGE"],[69,45,0,44,2,"SAM_MODEL"],[70,46,1,44,3,"SEGM_DETECTOR"],[71,21,0,42,3,"INT"],[73,48,0,44,1,"BBOX_DETECTOR"],[75,50,0,51,0,"MODEL"],[76,50,1,51,1,"IPADAPTER"],[77,33,0,50,0,"MODEL"],[78,32,1,50,1,"IPADAPTER"],[92,57,0,33,2,"IMAGE"],[97,33,1,51,2,"IMAGE"],[123,34,0,71,0,"MODEL"],[124,34,1,71,1,"CLIP"],[125,71,1,37,0,"CLIP"],[126,71,1,38,0,"CLIP"],[127,71,0,32,0,"MODEL"],[129,71,1,23,1,"CLIP"],[146,51,0,23,0,"MODEL"],[192,104,0,105,1,"FACE_TOOLKITS"],[193,28,0,105,0,"IMAGE"],[196,39,0,106,1,"IMAGE"],[197,106,0,57,0,"IMAGE"],[198,106,0,57,0,"IMAGE"],[199,106,0,40,0,"IMAGE"],[201,105,0,106,0,"IMAGE"],[202,71,0,108,0,"MODEL"],[203,108,0,33,0,"MODEL"],[204,108,1,33,1,"IPADAPTER"]],"groups":[{"id":1,"title":"face","bounding":[3343.55029296875,-1591.861572265625,790.55517578125,539.15576171875],"color":"#3f789e","font_size":24,"flags":{}},{"id":2,"title":"ipadapter","bounding":[4805.947265625,-1755.3321533203125,836.096435546875,442.7391357421875],"color":"#3f789e","font_size":24,"flags":{}},{"id":3,"title":"core","bounding":[4800.17626953125,-1199.23291015625,2616.923828125,879.81787109375],"color":"#3f789e","font_size":24,"flags":{}},{"id":7,"title":"Group","bounding":[3367.918701171875,-1845.0328369140625,687.534423828125,165.60000610351562],"color":"#3f789e","font_size":24,"flags":{}},{"id":8,"title":"Group","bounding":[5687.19189453125,-1743.7191162109375,349.01904296875,404.3453674316406],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":1.5535220464769843,"offset":[-4428.698123993707,1656.4868246140072]},"reroutes":[{"id":1,"pos":[5030.447265625,-1226.4573974609375],"linkIds":[127,202]}],"linkExtensions":[{"id":127,"parentId":1},{"id":202,"parentId":1}]},"version":0.4}